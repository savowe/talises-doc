<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Sascha Vowe">
    <link rel="canonical" href="https://sascha.vowe.eu/talises-doc/user-guide/time-propagation/">
    <link rel="shortcut icon" href="../../img/favicon.ico">

    
    <title>Propagate the wave-function - TALISES Documentation</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/base.min.css" rel="stylesheet">
    <link href="../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../..">TALISES Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../installation/">Installation</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../generating_a_wave-function/">Generating a wave-function</a>
</li>

                        
                            
<li >
    <a href="../handling_binary_data/">Handling binary data</a>
</li>

                        
                            
<li class="active">
    <a href="./">Propagate the wave-function</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../examples/potential_barrier/">Potential barrier</a>
</li>

                        
                            
<li >
    <a href="../examples/1D_harmonic_trap/">Atom interferometry in 1D harmonic trap</a>
</li>

                        
                            
<li >
    <a href="../examples/2D_harmonic_trap/">Momentum transfer in 2D harmonic trap</a>
</li>

                        
                            
<li >
    <a href="../examples/Raman_transitions/">Stimulated Raman transitions</a>
</li>

                        
                            
<li >
    <a href="../examples/BEC_scattering/">Bose-Einstein condensate collision</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../about/license/">License</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../handling_binary_data/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../examples/potential_barrier/">
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/savowe/talises-doc/blob/master/docs/user-guide/time-propagation.md"><i class="fab fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#propagate-the-wave-function">Propagate the wave-function</a></li>
            <li class="second-level"><a href="#sequence-items-interact-and-freeprop">Sequence items &lt;interact> and &lt;freeprop></a></li>
                
            <li class="second-level"><a href="#example">Example</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="propagate-the-wave-function">Propagate the wave-function</h1>
<hr />
<p><img alt="1D Rabi-oscillations figure" src="https://raw.githubusercontent.com/savowe/talises-doc/master/figs/1D_Rabi_oscillations.gif" /><br />
(You can find corresponding files in the <a href="https://github.com/savowe/talises/tree/master/examples/Rabi_oscillations">TALISES examples folder</a>)<br />
The heart of TALISES lies in the ability to propagate a wave-function 
\( \hat{U} |\Psi(r,t_0)\rangle = |\Psi(r,t)\rangle\) in accordance to the Schrödinger equation
<div>$$i\frac{\partial}{\partial t} |\Psi(r,t)\rangle 
= \Big( -\frac{\hbar}{2m} \nabla^2 + \frac{1}{\hbar}\hat{V} (\Psi, r, t) \Big)  |\Psi(r,t)\rangle .$$</div>
The wave-function includes internal and external degrees of freedom and you can easily
implement your own position-, time-dependent or nonlinear potential \( \hat{V} (\Psi, r, t) \).<br />
The configuration of the time-propagation and Hamiltonian is done using an XML-configuration file.
Important XML-tags are:</p>
<ul>
<li><code>&lt;N_THREADS&gt;</code>: number of threads used by program  </li>
<li><code>&lt;DIM&gt;</code>: number of spatial dimensions</li>
<li><code>&lt;INTERNAL_DIM&gt;</code>: number of internal degrees of freedom</li>
<li><code>&lt;FILENAME&gt;</code>: name of the binary file representing the wave-function generated by <a href="./user-guide/generating_a_wave-function">gen_psi_0</a>. 
There need to be as many files as internal degrees of freedom</li>
<li><code>&lt;M&gt;</code>: mass \(m\) used in the kinetic term of the Schrödinger equation. </li>
<li><code>&lt;T_SCALE&gt;</code>: convenient scaling factor for time units in sequence attributes</li>
<li><code>&lt;CONSTANTS&gt;</code>: here we define constants used in the Hamiltonian's expression</li>
<li><code>&lt;SEQUENCE&gt;</code>: here we declare the Hamiltonian and which numerical procedure to use</li>
</ul>
<h3 id="sequence-items-interact-and-freeprop">Sequence items &lt;interact> and &lt;freeprop></h3>
<p>There are two types of sequences: &lt;interact> and &lt;freeprop>. Before we explain the differences, let us see what they have in common.
A sequence might look like this</p>
<pre><code class="xml">&lt;SEQUENCE&gt;
  &lt;freeprop dt=&quot;2&quot; Nk=&quot;20&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
  V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot;   
  V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
  &gt;1000&lt;/freeprop&gt;
  &lt;interact  dt=&quot;0.02&quot; Nk=&quot;500&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
    V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot; V_12_real=&quot;0&quot; V_12_imag=&quot;0&quot;
                                V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
  &gt;1000&lt;/interact&gt;
&lt;/SEQUENCE&gt;
</code></pre>

<p>A sequence item tells the programm what the matrix elements of the potential term \(\hat{V}/\hbar\) are.
For this one must define the attributes <code>V_ij_real</code> and <code>V_ij_imag</code> in the sequence item.
Just as in the generation of the initial wavefunction, the real and imaginary part are stated seperately.<br />
Predefined constants and variables your can use are <code>pi</code> and <code>e</code> and <code>x</code>, <code>y</code>, <code>z</code>, <code>t</code> and the real and imaginary 
probabillity amplitudes <code>psi_j_real</code> and <code>psi_j_imag</code> (\(j\) denotes the corresponding internal state).<br />
Furthermore, you can use the <a href="./user-guide/generating_a_wave-function/#build-in-functions">build-in functions from the muparser libary</a> in the matrix elements.<br />
&nbsp;&nbsp;&nbsp;&nbsp;<strong>Attributes:</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>dt</strong>: time-step increment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>Nk</strong>: number of time steps after which the wave-function is saved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>output_freq</strong>: defines how the wave-function is saved.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>"each"</code> saves the wavefunction after every \(N_k\)-th step as a seperate file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>"packed"</code> saves the wavefunction after every \(N_k\)-th step and appends it to an existing file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>"last"</code> saves the wavefunction just at the last time-step <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>pn_freq</strong>: can be used in order the evluate the particle number in the internal states.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>"each"</code> evaluated population after every \(N_k\)-th step<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>"last"</code> evaluated population just at the last time-step<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>"none"</code> does nothing  </p>
<p>The length of time the sequence is supposed to be executed is the value of the sequence item. In the above example both sequences, &lt;interact> and &lt;freeprop>, are lasting 1000 seconds. The time units can be scaled via the <code>&lt;T_SCALE&gt;</code> tag. For example, if we set <code>&lt;T_SCALE&gt;1e-6&lt;/T_SCALE&gt;</code> the time units in the sequence attributes become \(\mu\)s, which can be easier to read.<br />
<strong>Now to the simple difference between &lt;interact> and &lt;freeprop></strong>:<br />
interact invokes a numerical diagonalization of the internal state Hamiltonian \(V\).
This has to be used when the potential term is not diagonal and interactions between the states are simulated. 
freeprop can be used when the potential is diagonal and is hence faster in computinng the time-propagation.
You do not need to define off-diagonal matrix elements in a freeprop sequence item.</p>
<h3 id="example">Example</h3>
<p>(You can find this example in the <a href="https://github.com/savowe/talises/tree/master/examples/Rabi_oscillations">TALISES examples folder</a>)<br />
First let us generate a simple 1D Gaussian wavepacket </p>
<pre><code class="xml">%gauss.xml
&lt;SIMULATION&gt;
  &lt;DIM&gt;1&lt;/DIM&gt;
  &lt;FILENAME&gt;0.000_1.bin&lt;/FILENAME&gt;
  &lt;PSI_REAL_1D&gt;exp( -0.25*((x-x_0)/sigma_x)^2 )&lt;/PSI_REAL_1D&gt;
  &lt;PSI_IMAG_1D&gt;0&lt;/PSI_IMAG_1D&gt;
  &lt;ALGORITHM&gt;
    &lt;NX&gt;256&lt;/NX&gt;
    &lt;XMIN&gt;-10e-6&lt;/XMIN&gt;
    &lt;XMAX&gt;10e-6&lt;/XMAX&gt;
  &lt;/ALGORITHM&gt;
  &lt;CONSTANTS&gt;
    &lt;N&gt;1&lt;/N&gt;
    &lt;x_0&gt;0&lt;/x_0&gt;
    &lt;sigma_x&gt;1e-6&lt;/sigma_x&gt;
  &lt;/CONSTANTS&gt;
&lt;/SIMULATION&gt;
</code></pre>

<p>and a second, empty internal state which shall be the excited state</p>
<pre><code class="xml">%zero.xml
&lt;SIMULATION&gt;
  &lt;DIM&gt;1&lt;/DIM&gt;
  &lt;FILENAME&gt;0.000_2.bin&lt;/FILENAME&gt;
  &lt;PSI_REAL_1D&gt;0&lt;/PSI_REAL_1D&gt;
  &lt;PSI_IMAG_1D&gt;0&lt;/PSI_IMAG_1D&gt;
  &lt;ALGORITHM&gt;
    &lt;NX&gt;256&lt;/NX&gt;
    &lt;XMIN&gt;-10e-6&lt;/XMIN&gt;
    &lt;XMAX&gt;10e-6&lt;/XMAX&gt;
  &lt;/ALGORITHM&gt;
  &lt;CONSTANTS&gt;
     &lt;N&gt;1&lt;/N&gt;
  &lt;/CONSTANTS&gt;
&lt;/SIMULATION&gt;
</code></pre>

<p>Generate the wave-functions by typing</p>
<pre><code class="bash">gen_psi_0 gauss.xml
gen_psi_0 zero.xml
</code></pre>

<p>The time-propagation is defined by the following code</p>
<pre><code class="xml">%timeprop.xml
&lt;SIMULATION&gt;
  &lt;N_THREADS&gt;4&lt;/N_THREADS&gt;
  &lt;DIM&gt;1&lt;/DIM&gt;
  &lt;INTERNAL_DIM&gt;2&lt;/INTERNAL_DIM&gt;
  &lt;FILENAME&gt;0.000_1.bin&lt;/FILENAME&gt;
  &lt;FILENAME_2&gt;0.000_2.bin&lt;/FILENAME_2&gt;
  &lt;ALGORITHM&gt;
    &lt;T_SCALE&gt;1e-6&lt;/T_SCALE&gt;
    &lt;M&gt;5e-26&lt;/M&gt;
  &lt;/ALGORITHM&gt;
  &lt;CONSTANTS&gt;
    &lt;f_R&gt;2500&lt;/f_R&gt;
  &lt;/CONSTANTS&gt;
  &lt;SEQUENCE&gt;
    &lt;freeprop dt=&quot;2&quot; Nk=&quot;20&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
    V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot;     
    V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
    &gt;1000&lt;/freeprop&gt;
    &lt;interact  dt=&quot;0.02&quot; Nk=&quot;500&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
      V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot; V_12_real=&quot;2*pi*f_R/2&quot; V_12_imag=&quot;0&quot;
                                  V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
    &gt;1000&lt;/interact&gt;
    &lt;freeprop dt=&quot;2&quot; Nk=&quot;20&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
    V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot;     
    V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
    &gt;1000&lt;/freeprop&gt;
  &lt;/SEQUENCE&gt;
&lt;/SIMULATION&gt;
</code></pre>

<p>and execute the time-propagation with</p>
<pre><code class="bash">talises timeprop.xml
</code></pre>

<h4><strong>Step-by-step examination</strong></h4>
<p>We go through <code>timeprop.xml</code> line by line:</p>
<pre><code class="xml">  &lt;N_THREADS&gt;4&lt;/N_THREADS&gt;
  &lt;DIM&gt;1&lt;/DIM&gt;
  &lt;INTERNAL_DIM&gt;2&lt;/INTERNAL_DIM&gt;
</code></pre>

<p>We declare to use 4 threads for our simulation of a spatially one dimensional wave-function with two internal degrees of freedom</p>
<pre><code class="xml">  &lt;FILENAME&gt;0.000_1.bin&lt;/FILENAME&gt;
  &lt;FILENAME_2&gt;0.000_2.bin&lt;/FILENAME_2&gt;
</code></pre>

<p>We specify the file paths of the wave-functions generated by gen_psi_0.
We load the files as the two internal states of which one is the Gaussian wave-packet and the other one empty.<br />
Note: the file paths are relative to your working directory.</p>
<pre><code class="xml">  &lt;ALGORITHM&gt;
    &lt;T_SCALE&gt;1e-6&lt;/T_SCALE&gt;
    &lt;M&gt;5e-26&lt;/M&gt;
  &lt;/ALGORITHM&gt;
</code></pre>

<p>We scale the time attributes in our sequence items, so that they are given in \(\mu\)s. 
The mass of the particle is \(m=5\cdot 10^{-25} \,\text{kg}\).<br />
Note: The parameter <code>&lt;M&gt;</code> defines the mass in the kinetic term of the Schrödinger equation nad thus only affects the kinetic term.</p>
<pre><code class="xml">  &lt;CONSTANTS&gt;
    &lt;f_R&gt;2500&lt;/f_R&gt;
  &lt;/CONSTANTS&gt;
</code></pre>

<p>We define one constant \(f_R\) which we can use later on in the description of the potential matrix-elements \(V\)</p>
<pre><code class="xml">  &lt;SEQUENCE&gt;
    &lt;freeprop dt=&quot;2&quot; Nk=&quot;20&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
    V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot;     
    V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
    &gt;1000&lt;/freeprop&gt;
</code></pre>

<p>The sequence starts with a \(1000\, \mu \text{s}\) long freeprop item. The time-steps are \(2\, \mu \text{s}\) long and the wave-function will be saved
every 20th step. The wave-packet freely propagates.</p>
<pre><code class="xml">    &lt;interact  dt=&quot;0.02&quot; Nk=&quot;500&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
      V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot; V_12_real=&quot;2*pi*f_R/2&quot; V_12_imag=&quot;0&quot;
                                  V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
    &gt;1000&lt;/interact&gt;
</code></pre>

<p>We start a \(1000\, \mu \text{s}\) interact sequence with
$$
V/\hbar = \frac{1}{2}
\begin{pmatrix}
0 &amp; \Omega_R\\
\Omega_R &amp; 0
\end{pmatrix}
= 
 \frac{1}{2}
 \begin{pmatrix}
0 &amp; 2\pi f_R\\
2\pi f_R &amp; 0
\end{pmatrix}.
$$
The Rabi-Hamiltonian in Dirac-picture and Rabi-frequency \(\Omega_R=2\pi f_R = 2\pi \cdot 2.5 \,\text{MHz}\), as defined in the <code>&lt;CONSTANTS&gt;</code> item.</p>
<pre><code class="xml">    &lt;freeprop dt=&quot;2&quot; Nk=&quot;20&quot; output_freq=&quot;packed&quot; pn_freq=&quot;each&quot;
    V_11_real=&quot;0&quot; V_11_imag=&quot;0&quot;     
    V_22_real=&quot;0&quot; V_22_imag=&quot;0&quot;
    &gt;1000&lt;/freeprop&gt;
  &lt;/SEQUENCE&gt;
&lt;/SIMULATION&gt;
</code></pre>

<p>After some Rabi-cycles we let the wave-packets freely expand again.  </p>
<h4>Plotting the result</h4>
<p>Start python, load talisestools und use the <a href="./user-guide/handling_binary_data/#the-talisestools-package">readall function</a> to extract the data from the binaries.</p>
<pre><code class="python">import talisestools as tt 
## Load binary data
data_psi1 = tt.readall(1)
data_psi2 = tt.readall(2)
# Get information for plots
psi1 = data_psi1[&quot;wavefunction&quot;]
psi2 = data_psi2[&quot;wavefunction&quot;]
t = data_psi1[&quot;t&quot;]
xMin = data_psi1[&quot;xMin&quot;]
xMax = data_psi1[&quot;xMax&quot;]
nDimX = data_psi1[&quot;nDimX&quot;]
</code></pre>

<p>With this we can start to create a animation of the wave-functions time-evolution.</p>
<pre><code class="python">import numpy as np
from matplotlib import pyplot as plt

x = np.linspace(xMin, xMax, nDimX)
max_density = np.max(np.abs(psi1)**2)
## Create animated gif
import gif
@gif.frame
def plot(psi1, psi2, x, t, max_density):
    den1_real = np.abs(np.real(psi1))**2
    den2_real = np.abs(np.real(psi2))**2
    den1_imag = np.abs(np.imag(psi1))**2
    den2_imag = np.abs(np.imag(psi2))**2
    den1 = den1_real + den1_imag
    den2 = den2_real + den2_imag

    fig, (ax1, ax2) = plt.subplots(2, sharex=True)
    ax1.set_title(r&quot;t = {:10.0f} $\mu$s&quot;.format(t))
    ax1.plot(x, den2, label = r&quot;$|\Psi|^2$&quot;)
    ax1.plot(x, den2_real, label = r&quot;|real$(\Psi|)^2$&quot;)
    ax1.plot(x, den2_imag, label = r&quot;|imag$(\Psi|)^2$&quot;)
    ax1.set_ylabel(r&quot;$|\Psi|^2$ [m$^{-1}$] excited&quot;)
    ax2.plot(x, den1, label = r&quot;$|\Psi|^2$&quot;)
    ax2.plot(x, den1_real, label = r&quot;|real$(\Psi|)^2$&quot;)
    ax2.plot(x, den1_imag, label = r&quot;|imag$(\Psi|)^2$&quot;)
    ax2.set_ylabel(r&quot;$|\Psi|^2$ [m$^{-1}$] ground&quot;)
    ax2.set_xlabel(r&quot;position [m]&quot;)
    ax1.set_xlim(np.min(x), np.max(x))
    ax1.set_ylim(0, max_density)
    ax2.set_ylim(0, max_density)
    ax1.legend()
    ax2.legend()
    ax1.grid()
    ax2.grid()
    plt.tight_layout()

frames = []
for i in range(0,len(t)):
    frame = plot(psi1[:,i], psi2[:,i], x, t[i], max_density)
    frames.append(frame)
    print(&quot;Generated plot &quot;+str(i)+&quot;/&quot;+str(len(t)-1))

gif.save(frames, &quot;eval.gif&quot;, duration=100)
</code></pre>

<p>The resulting gif should look like this<br />
<img alt="1D Rabi-oscillations figure" src="https://raw.githubusercontent.com/savowe/talises-doc/master/figs/1D_Rabi_oscillations.gif" /></p></div>
        
        
    </div>

    <footer class="col-md-12 text-center">
        
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
        </p>

        
        
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <script>var base_url = "../.."</script>
    
    <script src="../../js/base.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
