<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Sascha Vowe">
    <link rel="canonical" href="https://sascha.vowe.eu/talises-doc/user-guide/examples/BEC_scattering/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">

    
    <title>Bose-Einstein condensate collision - TALISES Documentation</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../../css/base.min.css" rel="stylesheet">
    <link href="../../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../../..">TALISES Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../../installation/">Installation</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../generating_a_wave-function/">Generating a wave-function</a>
</li>

                        
                            
<li >
    <a href="../../handling_binary_data/">Handling binary data</a>
</li>

                        
                            
<li >
    <a href="../../time-propagation/">Propagate the wave-function</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../potential_barrier/">Potential barrier</a>
</li>

                        
                            
<li >
    <a href="../1D_harmonic_trap/">Atom interferometry in 1D harmonic trap</a>
</li>

                        
                            
<li >
    <a href="../2D_harmonic_trap/">Momentum transfer in 2D harmonic trap</a>
</li>

                        
                            
<li >
    <a href="../Raman_transitions/">Stimulated Raman transitions</a>
</li>

                        
                            
<li class="active">
    <a href="./">Bose-Einstein condensate collision</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../about/license/">License</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../Raman_transitions/">
                            <i class="fas fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../../../about/license/">
                            Next <i class="fas fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/savowe/talises-doc/blob/master/docs/user-guide/examples/BEC_scattering.md"><i class="fab fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#bose-einstein-condensate-collision">Bose-Einstein condensate collision</a></li>
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="bose-einstein-condensate-collision">Bose-Einstein condensate collision</h1>
<p><img alt="BEC scattering simulation" src="https://raw.githubusercontent.com/savowe/talises-doc/master/figs/BEC_collision.gif" />
(You can find corresponding files in the <a href="https://github.com/savowe/talises/tree/master/examples/BEC_scattering">TALISES examples folder</a>)<br />
The time-evolution of Bose-Einstein condensates (BECs) is under certain approximations well described by a nonlinear Schrödinger equation
called the Gross-Pitaevskii equation
$$
i\frac{\partial}{\partial t} \Psi = -\frac{\hbar}{2m}\nabla^2 \Psi + \frac{1}{\hbar}V \Psi +  \frac{1}{\hbar} g |\Psi |^2 \Psi. <br />
$$
It is an effective single particle, nonlinear Schrödinger equation describing the collective behaviour of degenerate Bosons.
The nonlinear term is accounting for interparticle scattering processes with strength \(g = \frac{4\pi \hbar^2 a}{m}\),
where \(a\) is the s-scatter length.<br />
This scatter length can be different for different particles and even internal states.
We will simulate the collision of two BECs in different, orthogonal states.
This could mean that the BECs are made of the same atoms but in different internal states, or even entirely different atomic species.<br />
Since we will otherwise assume that \(V=0\), the Hamiltonian is
$$
H = -\frac{\hbar^2}{2m}\nabla^2 + 
\begin{pmatrix}
g_{11} |\Psi_1 |^2 + g_{12} |\Psi_2 |^2 &amp; 0\\
0 &amp; g_{21} |\Psi_1 |^2 + g_{22} |\Psi_2 |^2
\end{pmatrix}.
$$</p>
<p>In order make two BECs collide we give them an initial momentum in opposite direction.
Furthermore we rotate the coordinate system a bit, so it looks cooler.<br />
The first BEC is defined by</p>
<pre><code>&lt;SIMULATION&gt;
  &lt;DIM&gt;2&lt;/DIM&gt; 
  &lt;FILENAME&gt;0.000_1.bin&lt;/FILENAME&gt;
  &lt;PSI_REAL_2D&gt;exp( -0.25*((cos(phi)*x+sin(phi)*y-x_0)/sigma_x)^2 )*exp( -0.25*((-sin(phi)*y+cos(phi)*x-y_0)/sigma_y)^2 )*cos(k*(cos(phi)*x+sin(phi)*y))&lt;/PSI_REAL_2D&gt;
  &lt;PSI_IMAG_2D&gt;exp( -0.25*((cos(phi)*x+sin(phi)*y-x_0)/sigma_x)^2 )*exp( -0.25*((-sin(phi)*y+cos(phi)*x-y_0)/sigma_y)^2 )*sin(k*(cos(phi)*x+sin(phi)*y))&lt;/PSI_IMAG_2D&gt;
  &lt;CONSTANTS&gt;
    &lt;N&gt;1e5&lt;/N&gt;
    &lt;phi&gt;0.78&lt;/phi&gt;
    &lt;k&gt;5e6&lt;/k&gt;
    &lt;x_0&gt;-10e-6&lt;/x_0&gt;
    &lt;y_0&gt;0&lt;/y_0&gt;
    &lt;sigma_x&gt;1e-6&lt;/sigma_x&gt;
    &lt;sigma_y&gt;4e-6&lt;/sigma_y&gt;
  &lt;/CONSTANTS&gt;
   &lt;ALGORITHM&gt;
    &lt;NX&gt;512&lt;/NX&gt;
    &lt;NY&gt;512&lt;/NY&gt;
    &lt;XMIN&gt;-20e-6&lt;/XMIN&gt;&lt;XMAX&gt;20e-6&lt;/XMAX&gt;
    &lt;YMIN&gt;-20e-6&lt;/YMIN&gt;&lt;YMAX&gt;20e-6&lt;/YMAX&gt;
    &lt;/ALGORITHM&gt;
&lt;/SIMULATION&gt;
</code></pre>

<p>We offset it by \(-10\mu\text{m}\) in the x-direction and then rotate it by \(\phi = \pi / 4\).
Note that it is normalized to \(\int \text{d}r |\Psi |^2 = N = 10^{5}\).
We thus assume the BEC comprises of \(10^{5}\) atoms.<br />
The second BEC is generated with</p>
<pre><code>&lt;SIMULATION&gt;
  &lt;DIM&gt;2&lt;/DIM&gt; 
  &lt;FILENAME&gt;0.000_2.bin&lt;/FILENAME&gt;
  &lt;PSI_REAL_2D&gt;exp( -0.25*((cos(phi)*x+sin(phi)*y-x_0)/sigma_x)^2 )*exp( -0.25*((-sin(phi)*y+cos(phi)*x-y_0)/sigma_y)^2 )*cos(k*(cos(phi)*x+sin(phi)*y))&lt;/PSI_REAL_2D&gt;
  &lt;PSI_IMAG_2D&gt;exp( -0.25*((cos(phi)*x+sin(phi)*y-x_0)/sigma_x)^2 )*exp( -0.25*((-sin(phi)*y+cos(phi)*x-y_0)/sigma_y)^2 )*sin(k*(cos(phi)*x+sin(phi)*y))&lt;/PSI_IMAG_2D&gt;
  &lt;CONSTANTS&gt;
    &lt;N&gt;1e5&lt;/N&gt;
    &lt;phi&gt;-2.35&lt;/phi&gt;
    &lt;k&gt;5e6&lt;/k&gt;
    &lt;x_0&gt;-10e-6&lt;/x_0&gt;
    &lt;y_0&gt;0&lt;/y_0&gt;
    &lt;sigma_x&gt;3e-6&lt;/sigma_x&gt;
    &lt;sigma_y&gt;1e-6&lt;/sigma_y&gt;
  &lt;/CONSTANTS&gt;
   &lt;ALGORITHM&gt;
    &lt;NX&gt;512&lt;/NX&gt;
    &lt;NY&gt;512&lt;/NY&gt;
    &lt;XMIN&gt;-20e-6&lt;/XMIN&gt;&lt;XMAX&gt;20e-6&lt;/XMAX&gt;
    &lt;YMIN&gt;-20e-6&lt;/YMIN&gt;&lt;YMAX&gt;20e-6&lt;/YMAX&gt;
    &lt;/ALGORITHM&gt;
&lt;/SIMULATION&gt;
</code></pre>

<p>This one is also offset by \(-10\mu\text{m}\) in the x-direction but then rotated by \(\phi = -\frac{3\pi}{4}\).<br />
The time-propagation xml reads</p>
<pre><code>&lt;SIMULATION&gt;
  &lt;N_THREADS&gt;4&lt;/N_THREADS&gt;
  &lt;DIM&gt;2&lt;/DIM&gt;
  &lt;INTERNAL_DIM&gt;2&lt;/INTERNAL_DIM&gt;
  &lt;FILENAME&gt;0.000_1.bin&lt;/FILENAME&gt;
  &lt;FILENAME_2&gt;0.000_2.bin&lt;/FILENAME_2&gt;
  &lt;CONSTANTS&gt;
  &lt;g_11&gt;1e-14&lt;/g_11&gt;
  &lt;g_12&gt;5e-12&lt;/g_12&gt;
  &lt;g_21&gt;5e-12&lt;/g_21&gt;
  &lt;g_22&gt;1e-14&lt;/g_22&gt;
  &lt;/CONSTANTS&gt;
    &lt;ALGORITHM&gt;
      &lt;M&gt;1.44466899e-25&lt;/M&gt;
      &lt;T_SCALE&gt;1e-6&lt;/T_SCALE&gt;
   &lt;/ALGORITHM&gt;
  &lt;SEQUENCE&gt;
    &lt;freeprop Nk=&quot;50&quot; dt=&quot;2&quot; output_freq=&quot;packed&quot; pn_freq=&quot;none&quot;
    V_11_real=&quot;g_11*(psi_1_real^2+psi_1_imag^2)+g_12*(psi_2_real^2+psi_2_imag^2)&quot; V_11_imag=&quot;0&quot; 
    V_22_real=&quot;g_21*(psi_1_real^2+psi_1_imag^2)+g_22*(psi_2_real^2+psi_2_imag^2)&quot; V_22_imag=&quot;0&quot;
    &gt;6000&lt;/freeprop&gt; 
  &lt;/SEQUENCE&gt;
&lt;/SIMULATION&gt;
</code></pre>

<p>Note that \(|\Psi|^2 = (\text{Re}\Psi)^2 + (\text{Im}\Psi)^2\). 
We give the BEC an especially strong scattering strength accros internal states \(g_{12}=g_{21} &gt;&gt; g_{11} = g_{22}\).</p></div>
        
        
    </div>

    <footer class="col-md-12 text-center">
        
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
        </p>

        
        
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../../js/bootstrap-3.0.3.min.js"></script>
    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <script>var base_url = "../../.."</script>
    
    <script src="../../../js/base.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script src="../../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
